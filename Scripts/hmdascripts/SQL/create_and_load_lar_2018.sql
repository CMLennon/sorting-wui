-- filename: create_and_load_lar_2007.sql

DROP TABLE IF EXISTS hmda_public.lar_2018;
CREATE TABLE hmda_public.lar_2018(
    activity_year VARCHAR,
    lei VARCHAR,
    msa VARCHAR,
    state_code VARCHAR,
    county_code VARCHAR,
    census_tract VARCHAR,
    conforming_loan_limit VARCHAR,
    derived_loan_product_type VARCHAR,
    derived_dwelling_category VARCHAR,
    derived_ethnicity VARCHAR,
    derived_race VARCHAR,
    derived_sex VARCHAR,
    action_taken VARCHAR,
    purchaser_type VARCHAR,
    preapproval VARCHAR,
    loan_type VARCHAR,
    loan_purpose VARCHAR,
    lien_status VARCHAR,
    reverse_mortgage VARCHAR,
    open_end_line_of_credit VARCHAR,
    business_or_commercial_purpose VARCHAR,
    loan_amount VARCHAR,
    loan_to_value_ratio VARCHAR,
    interest_rate VARCHAR,
    rate_spread VARCHAR,
    hoepa_status VARCHAR,
    total_loan_costs VARCHAR,
    total_points_and_fees VARCHAR,
    origination_charges VARCHAR,
    discount_points VARCHAR,
    lender_credits VARCHAR,
    loan_term VARCHAR,
    prepayment_penalty_term VARCHAR,
    intro_rate_period VARCHAR,
    negative_amortization VARCHAR,
    interest_only_payment VARCHAR,
    balloon_payment VARCHAR,
    other_nonamortizing_features VARCHAR,
    property_value VARCHAR,
    construction_method VARCHAR,
    occupancy_type VARCHAR,
    manufactured_home_secured_property_type VARCHAR,
    manufactured_home_land_property_interest VARCHAR,
    total_units VARCHAR,
    multifamily_affordable_units VARCHAR,
    income VARCHAR,
    debt_to_income_ratio VARCHAR,
    applicant_credit_score_type VARCHAR,
    coapplicant_credit_score_type VARCHAR,
    applicant_ethnicity_1 VARCHAR,
    applicant_ethnicity_2 VARCHAR,
    applicant_ethnicity_3 VARCHAR,
    applicant_ethnicity_4 VARCHAR,
    applicant_ethnicity_5 VARCHAR,
    coapplicant_ethnicity_1 VARCHAR,
    coapplicant_ethnicity_2 VARCHAR,
    coapplicant_ethnicity_3 VARCHAR,
    coapplicant_ethnicity_4 VARCHAR,
    coapplicant_ethnicity_5 VARCHAR,
    applicant_ethnicity_observed VARCHAR,
    coapplicant_ethnicity_observed VARCHAR,
    applicant_race_1 VARCHAR,
    applicant_race_2 VARCHAR,
    applicant_race_3 VARCHAR,
    applicant_race_4 VARCHAR,
    applicant_race_5 VARCHAR,
    coapplicant_race_1 VARCHAR,
    coapplicant_race_2 VARCHAR,
    coapplicant_race_3 VARCHAR,
    coapplicant_race_4 VARCHAR,
    coapplicant_race_5 VARCHAR,
    applicant_race_observed VARCHAR,
    coapplicant_race_observed VARCHAR,
    applicant_sex VARCHAR,
    coapplicant_sex VARCHAR,
    applicant_sex_observed VARCHAR,
    coapplicant_sex_observed VARCHAR,
    applicant_age VARCHAR,
    coapplicant_age VARCHAR,
    applicant_age_above_62 VARCHAR,
    coapplicant_age_above_62 VARCHAR,
    submission_of_application VARCHAR,
    initially_payable_to_institution VARCHAR,
    aus_1 VARCHAR,
    aus_2 VARCHAR,
    aus_3 VARCHAR,
    aus_4 VARCHAR,
    aus_5 VARCHAR,
    denial_reason_1 VARCHAR,
    denial_reason_2 VARCHAR,
    denial_reason_3 VARCHAR,
    denial_reason_4 VARCHAR,
    tract_population VARCHAR,
    tract_minority_population_percent VARCHAR,
    ffiec_msa_md_median_family_income VARCHAR,
    tract_to_msa_income_percentage VARCHAR,
    tract_owner_occupied_units VARCHAR,
    tract_one_to_four_family_homes VARCHAR,
    tract_median_age_of_housing_units VARCHAR
);

COMMIT;

COPY hmda_public.lar_2018
FROM '/Users/connor/Desktop/GithubProjects/propval-wui/sorting-wui/Raw_data/HMDA/data/lar/lar_2018.dat'
    DELIMITER ',' ENCODING 'latin1' CSV HEADER ;